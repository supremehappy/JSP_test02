<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD MAPPER 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="myHomeMapper">
	<!-- 조회 값이 하나 이상일경우 빈 생성 -->
	<select id="selectMember" parameterType="String" resultType="model.UserInfo">
		select id, password from user_info where id=#{id}
	</select>
	
	<!-- 조회 값이 하나 일경우 빈 생성 없이 가능 -->
	<select id="selectMaxSeqno" resultType="Integer">
		select max(seqno) as max_seqno from bbs
	</select>
	<insert id="insetBBS" parameterType="model.BBSItem">
		insert into bbs
		values(#{seqno},#{title},#{content},#{id},#{bbs_date})
	</insert>
	
	<select id="selectMaxPid" resultType="Integer">
		select max(pid) as max_no from product_info
	</select>
	
	<insert id="insetPro" parameterType="model.ProItem">
		insert into product_info
		values(#{pid},#{name},#{price},#{p_date},#{content},#{id})
	</insert>
	
	<!-- 게시판 list 처리 -->
	<select id="selectBBS" resultType="model.BBSItem">
		select seqno, title, content, id, bbs_date from bbs
		order by seqno desc
	</select>	
	
	<!-- bbsitemservelt -->
	<select id="selectBBSItem" parameterType="Integer" resultType="model.BBSItem">
		select * from bbs where seqno =#{seqno}
	</select>
	
	<!-- bbslistservelt - readPageNum-->
	<select id="selectPage" resultType="Integer">
		select count(*) as num from bbs
	</select>
	
	<!-- bbslistservelt -readNextPage -->
	<select id="selectNextPage" parameterType="Integer" resultType="model.BBSItem">
		select * from bbs where seqno <![CDATA[<]]> #{seqno}
		order by seqno desc
	</select>
	
	<!-- bbslistservelt -readPrevPage -->
	<select id="selectPrevPage" parameterType="Integer" resultType="model.BBSItem">
		select seqno,title,id,bbs_date from
		(
			select seqno,title,id,bbs_date,rownum from
			(
				select * from 
				(
					select * from bbs where seqno > #{seqno}
					order by seqno desc
				)
				order by seqno
			)
			where rownum <![CDATA[ < ]]>=5 order by seqno desc
		)
	</select>
	
	<select id="selectPrevCount" parameterType="Integer" resultType="Integer">
		select count(*) as num from bbs where seqno > #{seqno}
	</select>
	
	<!-- bbslistservelt -readPage -->
	<select id="selectBBSPage" parameterType="Integer" resultType="model.BBSItem">
		select seqno, title, id, bbs_date from
		(
			select seqno, title, id, bbs_date, rownum rn from
			(
				select * from bbs order by seqno desc
			)
		)
		where (rn>((#{no}-1)*5)) and
		(rn <![CDATA[<]]> ((#{no}-1)*5)+6)
	</select>
	
	<select id="selectNextCount" parameterType="Integer" resultType="Integer">
		select count(*) as num from
		(
			select seqno, rownum rn from
			(
				select * from bbs order by seqno desc
			)
		)
		where rn>((#{no}-1)*5)
	</select>
</mapper>